function p = twomodegauss(m1, sig1, m2, sig2, A1, A2, k)
% twomodegauss - 生成双峰高斯分布
%   p = twomodegauss(m1, sig1, m2, sig2, A1, A2, k) 生成一个双峰高斯分布，
%   其中 m1 和 m2 是两个峰值的均值，sig1 和 sig2 是两个峰值的标准差，
%   A1 和 A2 是两个峰值的振幅，k 是偏移参数。
%
%   输入参数:
%   - m1: 第一个峰值的均值
%   - sig1: 第一个峰值的标准差
%   - m2: 第二个峰值的均值
%   - sig2: 第二个峰值的标准差
%   - A1: 第一个峰值的振幅
%   - A2: 第二个峰值的振幅
%   - k: 偏移参数
%
%   输出参数:
%   - p: 生成的双峰高斯分布

% 计算第一个峰值的高斯分布部分
c1 = A1 * (1 / ((2 * pi) ^ 0.5) * sig1);
k1 = 2 * (sig1 ^ 2);

% 计算第二个峰值的高斯分布部分
c2 = A2 * (1 / ((2 * pi) ^ 0.5) * sig2);
k2 = 2 * (sig2 ^ 2);

% 生成 0 到 1 之间的等间隔数据点
z = linspace(0, 1, 256);

% 计算双峰高斯分布
p = k + c1 * exp(-((z - m1) .^ 2) ./ k1) + c2 * exp(-((z - m2) .^ 2) ./ k2);

% 归一化，使积分为 1
p = p ./ sum(p(:));
end
